import os
import random
import sys
import pytest
import json
from src.noble_linkedin_api import Linkedin
from src.noble_linkedin_api.utils.helpers import get_id_from_urn

TEST_LINKEDIN_USERNAME = os.getenv("LINKEDIN_USERNAME", "cameron.jordan@thatsnoble.com")
TEST_LINKEDIN_PASSWORD = os.getenv("LINKEDIN_PASSWORD", "Wordofmouth22")
TEST_PROFILE_ID = os.getenv("TEST_PROFILE_ID", "ACoAAAcLc-kBGrxZVGc1BYcF3trNSWWUXQUjswc")
TEST_PUBLIC_PROFILE_ID = os.getenv("TEST_PUBLIC_PROFILE_ID", "joshua-budman-7496b933")
TEST_CONVERSATION_ID = os.getenv("TEST_CONVERSATION_ID", "6419123050114375168")

REQUEST_HEADERS = {
    "user-agent": "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.6045.33 Safari/537.36",
    "accept-language": "en-AU,en-GB;q=0.9,en-US;q=0.8,en;q=0.7",
    "x-li-lang": "en_US",
    "x-restli-protocol-version": "2.0.0",
    "csrf-token": "ajax:0835618877918092985",
}

if not (
    TEST_LINKEDIN_USERNAME
    and TEST_LINKEDIN_PASSWORD
    and TEST_PROFILE_ID
    and TEST_PUBLIC_PROFILE_ID
    and TEST_CONVERSATION_ID
):
    print("Test config incomplete. Exiting...")
    sys.exit()

BIG_CO_LIST = ['3574854', '2296178', '905023', '33312816', '67125069', '10168251', '17960833', '84900622', '16219835', '9459232', '18765773', '3954657', '54342748', '11004778', '39750', '85430', '17985548', '2030200', '14682514', '12897794', '2944518', '2568979', '2568079', '30217', '2422393', '82323496', '68692', '3265836', '36998168', '163941', '17937855', '70877533', '224232', '2746866', '81896895', '2027242', '3801953', '5396383', '84738', '84120641', '519232', '74882602', '3698984', '68631655', '17914470', '2627327', '4802464', '2139901', '6800096', '2808012', '1337', '785828', '3769390', '10426104', '745190', '20388343', '75139030', '1762240', '72734261', '1009', '3118913', '71820993', '3858', '482819', '822535', '2963779', '21732796', '18092211', '12949663', '10976367', '9247504', '67722588', '167700', '1533251', '18324165', '88421015', '3654338', '10293199', '3352502', '12956456', '8697', '1', '753516', '10843671', '70570480', '94889', '33242739', '279570', '6636847', '28340358', '10863508', '28589', '5245293', '68582924', '585169', '1', '6412574', '27125196', '42679274', '2709', '96264150', '73817395', '10454372', '11549562', '1', '3338050', '10294984', '48826', '51626838', '11551591', '33246387', '31360100', '65138210', '17993988', '26188804', '8561', '64563898', '425281', '2509806', '28914294', '18235325', '3324785', '20346419', '9223407', '4191', '1443525', '67251798', '1163120', '9381348', '11864448', '2095549', '18511550', '5013970', '1063966', '83609', '869560', '98759331', '13277', '78426215', '3213996', '1098620', '37268488', '1', '10869389', '95761', '3502352', '12595690', '18514105', '17913802', '7572649', '1901089', '3637969', '6473048', '17950375', '80062', '73066015', '696618', '76609119', '47663543', '10649600', '7805267', '37508981', '10440404', '10141819', '96622', '22782', '17988315', '77737659', '5652', '16160438', '11208900', '68194053', '18342604', '55180404', '34226848', '1', '6462590', '65537306', '2527975', '31404660', '64963190', '68529', '80428197', '95714012', '1831952', '1032170', '2821922', '27015384', '2871213', '47199', '10695065', '220537', '5457541', '53585', '784652', '3240893', '6385214', '28534466', '2786985', '838774', '63084', '2465722', '64515483', '675562', '14777627', '6653417', '3806620', '7598431', '3793769', '64599999', '3335913', '5096787', '94098362', '22286668', '2316013', '65553930', '20483715', '3237676', '17954843', '18970210', '14634348', '1756690', '5020707', '2559311', '35466166', '1', '27062956', '1', '841640', '14821134', '27106547', '58426', '26606976', '9329725', '9331350', '3185', '3225833', '260387', '691913', '3734741', '18006806', '156593', '15180908', '9475578', '35563675', '1480', '2681959', '52129989', '81493943', '10564588', '10532758', '11765969', '3780137', '3059522', '68071185', '6615109', '9319142', '18347648', '9192400', '1028', '3518429', '2147899', '23729203', '91653504', '2726400', '1910768', '24580', '46899', '13046874', '1281172', '14515150', '11750861', '5168486', '13006904', '110372', '1203323', '10638445', '9310783', '792882', '66632259', '10786843', '77798425', '19114475', '5287647', '11813107', '3113444', '80443373', '40652422', '16222719', '148972', '1199744', '11105030', '7589372', '3875906', '3999305', '2525169', '80112774', '40852533', '250981', '40952521', '1165219', '3263132', '2880747', '135092', '35642812', '10551016', '79621246', '2564867', '17905591', '2306727', '18278554', '11075131', '17999133', '141203', '974353', '36229', '67838428', '68503832', '150154', '515401', '276981', '1273258', '657407', '2444687', '75147', '17932237', '81546864', '19113307', '1826785', '205127', '1279462', '13057840', '221390', '1925113', '1484320', '1189119', '76187266', '1015745', '3032072', '33240674', '45661', '68673565', '236413', '936817', '11221062', '426253', '18017641', '1', '10168756', '68201369', '75526185', '72755677', '65476170', '564709', '74019356', '91193121', '2198587', '1617574', '1', '98888', '4839088', '3787025', '65582532', '2908815', '433786', '2845325', '2621568', '494906', '1', '1907786', '3610352', '77288547', '31424142', '84151790', '28183843', '9866841', '18680810', '400528', '82303506', '3402', '66326632', '65634136', '40966708', '10627926', '163841', '956754', '89759', '97225553', '1475629', '13203650', '6408224', '97358490', '285750', '5362430', '210324', '6598255', '1512210', '18313096', '6449047', '14559299', '10786107', '10557356', '3837459', '2729320', '15245541', '1', '64869573', '6463097', '68753931', '10673871', '1606201', '13996489', '71696123', '17906988', '5143366', '1916708', '5243789', '21567', '1306066', '3302167', '24796585', '2508983', '919920', '410136', '2636221', '1276962', '105048', '2728700', '2474609', '14812008', '210447', '18809904', '68000392', '2692842', '17958274', '418095', '11256852', '15638602', '1902816', '10483551', '21870', '74711934', '3270360', '10552989', '5370025', '2336259', '11152735', '1283', '2135371', '2753593', '1140722', '1005782', '10894220', '1410451', '5398451', '2829', '2777859', '658814', '18729422', '10295665', '2590712', '809535', '79564510', '17459', '66935', '6449', '3640016', '12770', '73061937', '547603', '75152339', '31464352', '3477522', '10696561', '25022531', '10917972', '5393746', '2585024', '18214289', '24440', '47456', '4553618', '72191048', '71651175', '10083988', '916471', '903862', '18639218', '17968251', '65447436', '10335209', '14034745', '79918123', '78363156', '2495955', '27131421', '11843084', '18937694', '11069710', '2137', '64519487', '6384928', '74967476', '67488932', '91322696', '556192', '72544520', '1478477', '3526047', '40826373', '92633772', '3232170', '1743', '3681130', '6646849', '5146852', '1441', '213943', '13238054', '17943523', '2990290', '70418097', '1', '2794336', '7572806', '76516964', '13015659', '1691125', '5071271', '31412233', '5195', '165007', '5361590', '11235113', '366757', '16194366', '2299055', '1713495', '1377014', '28431502', '629551', '2860994', '3284102', '35587681', '69482415', '2307', '2979038', '51693734', '2846834', '10955499', '5366578', '92547230', '22530', '28405846', '17980608', '18225712', '2105', '10152121', '2472111', '33281930', '10282934', '1063', '37430476', '10410260', '17981061', '434598', '30585737', '3273466', '582024', '3112567', '77100597', '18052275', '21064', '12952763', '10147065', '292886', '43327262', '70934599', '75671009', '2975488', '13152', '30153455', '68858083', '75391078', '18047008', '2685640', '25072573', '14616669', '3535535', '356254', '7097477', '1846727', '10037', '26220387', '22422646', '2941990', '18922914', '258303', '73848327', '2314366', '89097316', '69424029', '10275909', '18087543', '18097967', '406283', '35521359', '14033986', '18208078', '116468', '3037808', '3033', '19022', '89494193', '1482', '27011537', '16182645', '16187918', '80410815', '972093', '13414481', '11091476', '2639824', '18233920', '10422988', '72332038', '10525955', '3610169', '18801614', '2785196', '1', '7161590', '21121', '278844', '756602', '2474773', '2581389', '4818401', '37441642', '32073', '3572530', '18040722', '17896192', '1331150', '18529433', '33223250', '1109456', '1381008', '1386010', '38112487', '11712807', '8482', '74284749', '42308080', '706074', '395871', '75078709', '65787323', '80750', '10126494', '4974927', '1850855', '2385', '18775391', '771333', '35504188', '3768148', '1043', '9396432', '2652543', '351772', '2498463', '26662243', '18826329', '2471802', '19214332', '34958967', '167798', '26480892', '11357449', '4994675', '18210353', '80733748', '11511823', '30040', '546070', '2998372', '78808539', '5324440', '33751', '11386524', '31432400', '10043614', '10451937', '1', '20792', '10389765', '552310', '10894709', '2277385', '19022508', '6918', '1027191', '525605', '3363809', '3772163', '1163987', '10818764', '10500276', '47593724', '9412019', '3719686', '3081120', '13798', '5278147', '1310548', '1', '393837', '75409497', '4855845', '644776', '12178284', '3559341', '9434703', '74114199', '150716', '29031339', '10435968', '72594559', '10638732', '1468444', '30646417', '21065170', '80445543', '2741671', '5073227', '19151717', '10055480', '10608407', '28824343', '18271255', '11827300', '9297288', '35479358', '70963278', '2793314', '31431064', '10950383', '1', '11018784', '389023', '250378', '18072579', '1', '22026', '77158228', '71822710', '7971559', '9487844', '1915608', '2360790', '71660228', '3641086', '67136047', '2802', '9789094', '10592980', '64381341', '53515667', '15511300', '67282078', '3653845', '2508846', '12619110', '96240607', '2365653', '484413', '81072', '60605', '5013440', '1039301', '974105', '2715876', '11180541', '3638379', '4806788', '2978', '4821384', '487830', '162487', '11076456', '52187573', '9180416', '11610888', '11191671', '5127049', '1198680', '76090617', '3071544', '33195247', '14573638', '2916318', '18700707', '6402068', '349297', '109714', '18103664', '5197748', '38115511', '68702999', '53221907', '7579497', '11330185', '27455280', '115913', '14008700', '37900051', '6622382', '71544384', '3729249', '5159145', '13623988', '22244', '76647045', '125999', '1', '10358578', '28980144', '34693827', '60101', '18055127', '20558905', '10520861', '2662098', '17719', '42681818', '733622', '5193621', '10041033', '3353745', '60645', '64521767', '5202118', '64286540', '4526', '1036196', '1515446', '16176904', '29119902', '2915478', '3066550', '7956510', '10653469', '2384213', '429471', '2464624', '17926327', '42373587', '18533177', '29365766', '40982', '1', '930062', '3349412', '3650502', '18767393', '454586', '10893210', '2752977', '64251', '1419', '5327095', '2326557', '18516995', '11347442', '6650518', '5224218', '553325', '18281', '28543', '10789325', '10338902', '49520', '13305381', '22329', '26199658', '10438572', '10079130', '11235670', '17465', '2783482', '10478150', '51698956', '67978691', '15185475', '71323820', '340460', '17948815', '81719593', '9474278', '2736403', '451367', '211380', '1680505', '17932068', '7600452', '18382984', '727967', '88844', '18284995', '82811792', '3345089', '15961013', '10129177', '10346930', '2852146', '1', '76201674', '71572264', '4819784', '20112469', '362862', '18245154', '93369006', '69249353', '15212511', '28665578', '2869053', '6822873', '3257139', '76237726', '209974', '10154116', '2432', '66320584', '9217518', '1008685', '2522620', '814025', '3557157', '461158', '5053115', '19252217', '5337093', '29014740', '1432337', '69529378', '86954526', '1253671', '14051', '212979', '76138455', '807257', '235930', '2515651', '51630838', '1058004', '69603147', '3842382', '4824353', '9389290', '67760135', '6408728', '1', '5911974', '783611', '10393157', '87743979', '10043125', '33316', '2706887', '3521364', '5241109', '6391875', '3127449', '1', '82297236', '3831755', '10058277', '22343740', '70585', '2608095', '9282510', '2499061', '6439916', '71276729', '277147', '3166195', '18037948', '54372844', '1404148', '164852', '19239958', '80702779', '2957988', '2361403', '1647020', '2641', '13238588', '74008021', '11074753', '11353', '35540427', '30129363', '78760458', '36151631', '3026823', '11288', '42782711', '89371916', '45918', '2261626', '2345120', '10620', '2685866', '367996', '10987088', '80852664', '3036405', '69091284', '49130051', '305585', '18377311', '2981', '18094713', '54445141', '1885711', '5376263', '229978', '36087208', '3646800', '10459912', '19458140', '101598', '1317992', '1892859', '28993324', '13404236', '2296304', '64894717', '402414', '10286612', '10409556', '3011295', '56463646', '56039', '2774351', '72077584', '68275317', '449326', '28223', '96477615', '31036599', '17990112', '42640', '8996', '3231829', '1244071', '12904445', '11781525', '19946725', '19089475', '74047952', '35939884', '3027', '1951', '31983637', '82802844', '6470438', '165303', '1038404', '65347246', '16201214', '67155308', '7575309', '2453129', '5128', '77770984', '1297548', '10650056', '79917483', '14547730', '9210946', '81510754', '1472599', '3649549', '16176980', '78456837', '90246988', '2645381', '1612748', '90676699', '14775097', '17982379', '69737622', '2253531', '2580834', '67294623', '11783083', '89982580', '68244395', '2675641', '1', '705968', '87217500', '2576937', '82785088', '26167', '28167130', '6584179', '987650', '2820239', '86455807', '95720455', '1770643', '1462126', '3197016', '1953539', '2679402', '19527065', '9430107', '20353970', '18064', '27155905', '34617366', '9261935', '256288', '9294906', '1455', '9215047', '18340489', '18116403', '28129339', '2983815', '11341714', '2881051', '891955', '167027', '40961723', '82607', '68052787', '509089', '19070696', '26208212', '11140720', '12998367', '2746760', '15180764', '18700411', '5150723', '1701962', '88470', '2078', '3038939', '2950042', '3326900', '17902201', '9445285', '18991194', '128505', '2768338', '16234006', '79239055', '68985007', '93347808', '10402752', '3276598', '13073186', '6451003', '26244228', '10309911', '27042439', '2553488', '27096700', '11113749', '83952955', '18098971', '11812687', '11004633', '3610041', '1493088', '18099570', '5204139', '30501', '3229238', '1', '10678048', '66734450', '4865388', '3043691', '18222373', '5005010', '18223999', '2716125', '587231', '1146', '10595640', '2497653', '68998139', '3290495', '2902758', '732400', '13366438', '88367', '21811', '27171357', '4982479', '2687110', '10237392', '5129180', '561951', '11248746', '3805368', '18266288', '18966068', '11254442', '9422728', '6587396', '680194', '2951530', '5043394', '37896348', '3374473', '3559595', '25007998', '29367144', '13227737', '11420978', '1384734', '10225939', '5390837', '35627662', '10662222', '3626907', '21971', '18021229', '17980802', '21377', '18752482', '3037695', '451825', '27239038', '11098985', '1004213', '11980', '11644155', '987663', '6634771', '3991822', '19197334', '101105', '4990300', '28895537', '13020394', '33515334', '27155043', '35627771', '5200274', '6798630', '3498351', '16272', '2841893', '5351527', '10224913', '3119217', '3801155', '81880644', '11072387', '1400', '11754526', '2807238', '12899257', '1953412', '55895', '1632202', '1290637', '9460229', '2316358', '9492211', '3796428', '18450430', '67929492', '28152758', '18040039', '10619369', '10058404', '5177220', '42815', '18776174', '1523656', '9288295', '10968029', '37095493', '76077019', '3715155', '12996946', '2944174', '1', '2925058', '3128', '29016145', '3278906', '1299161', '82428121', '447037', '36118448', '33311374', '10538153', '18486917', '71059979', '2317208', '25065657', '8141', '4840686', '28521022', '1', '237114', '18924995', '16152358', '28596525', '18802834', '5157252', '10358347', '10042051', '18100730', '18936735', '35930', '15244508', '6611801', '30706797', '804150', '2446860', '15230580', '2963249', '3184', '64767621', '3531079', '18711429', '106943', '42364695', '3012137', '96394701', '18756359', '27191314', '69450965', '11783987', '399351', '31071983', '7801411', '6453825', '1786002', '9293724', '121420', '28598611', '2491343', '64626903', '4795130', '75123331', '41163', '37044679', '10284873', '9319466', '781738', '2387492', '435210', '11823575', '5322109', '19118465', '19021238', '10609255', '58632', '316675', '4829132', '897372', '43244238', '18832843', '73865051', '806711', '2582575', '829635', '11214850', '497464', '64605350', '1035', '2602522', '2702447', '10550545', '5273045', '275831', '77245349', '3069', '74949183', '76718489', '18764909', '27232417', '10009944', '10154428', '601078', '3522374', '10472126', '11172732', '67131469', '3300917', '69557125', '1272971', '2498', '1', '3226195', '35689977', '65555720', '45654398', '85823', '11124975', '10037351', '348836', '142536', '17916760', '10450144', '834380', '15790528', '5603', '984397', '90869121', '78413348', '88873', '1661045', '2254852', '64289944', '18125', '79856116', '79411135', '3509022', '113254', '3741', '1', '229433', '2426576', '49697', '55179474', '1727310', '96089', '2360297', '37005917', '5244860', '548864', '11056353', '52121337', '90463960', '72048615', '4825175', '3258083', '51115285', '33194533', '33235918', '3318359', '32097', '10470041', '30188058', '14069635', '18505670', '97250', '2857387', '483997', '1752877', '31235724', '17946876', '167813', '2047736', '1', '76856758', '2776536', '19405', '76119742', '66315822', '74073228', '49102278', '72276938', '16233069', '5381724', '2371907', '10591195', '27089711', '11009191', '65901227', '686067', '11267', '10885965', '73825833', '18269730', '11839156', '74704820', '5102948', '259661', '2221', '7957889', '10600091', '73074', '72091095', '9361928', '3147684', '76586558', '10679386', '74951526', '67706259', '37218813', '1', '1', '2418207', '3509899', '1687283', '9446039', '3110635', '5231936', '31430324', '3353095', '5083171', '29014871', '12602189', '1588586', '18364911', '35668572', '9223', '16225248', '64914745', '2907294', '3532968', '2579812', '2594209', '43352617', '14071957', '1042291', '903031', '3826060', '2649878', '51635152', '13195422', '9506055', '10815921', '9505', '1107556', '71999253', '15081045', '15239560', '24461093', '64890982', '1508213', '11220316', '18769344', '37211972', '2202789', '77751949', '18734010', '11037222', '18941384', '65677231', '54178', '82653698', '10823174', '9060', '30703767', '18543671', '1', '1872127', '3035857', '5173204', '2665061', '201287', '5161932', '1655309', '2158708', '33214405', '10313723', '15245045', '30631331', '2113189', '236924', '79651440', '2557484', '52118048', '2779653', '28451273', '68238669', '10610473', '1', '1977526', '6577635', '14055650', '94418378', '85029', '2008369', '48974', '79906878', '28055', '83653', '6465149', '10287933', '3582832', '11142008', '1650627', '938098', '65806028', '74076386', '1912597', '18187370', '68516709', '3170694', '28921121', '6041801', '10783136', '2311', '451129', '71072314', '5902262', '11736263', '65839213', '1', '2449391', '19057432', '3840963', '279069', '5161', '42084', '6460', '74352394', '20734', '842135', '6457231', '26559108', '10812560', '72119254', '9201758', '15208034', '51709794', '10393857', '2725088', '15205067', '10667', '2888838', '9459612', '28163', '260325', '18277', '9429370', '10043747', '10364172', '2868', '17966039', '43338259', '3592486', '2814733', '18155659', '18078218', '18421890', '2806711', '91026783', '3651177', '1406226', '516464', '1339603', '1', '1384', '74058713', '11178670', '10533439', '13020859', '250060', '240158', '11012628', '6473809', '662235', '68175646', '3157813', '15233017', '11760139', '27229963', '2278364', '11072801', '9491418', '2398206', '16154625', '4982392', '2355552', '18065999', '18446078', '3237551', '10257992', '760976', '429838', '38091470', '11046286', '7268', '11062575', '35478862', '74069524', '89833817', '33298433', '10805423', '5268984', '2769799', '17935538', '1', '11098948', '69714272', '5208813', '2429267', '3105355', '36090182', '27242744', '9634', '3717712', '23684925', '3184655', '6626319', '10448147', '2675499', '96527549', '1872564', '76327836', '10491772', '2363237', '11205761', '1024254', '53570583', '832197', '1071559', '446454', '11093134', '1146830', '76031', '2412659', '68615079', '1001748', '18018126', '18372003', '37493327', '9375542', '810383', '12895089', '76230254', '30666904', '71555983', '2211704', '16188970', '18553242', '11836792', '20322956', '85328256', '33247900', '1', '3351565', '18258628', '1028344', '2612274', '145267', '2864641', '6662328', '11116028', '10644441', '9382795', '74109577', '10574043', '2488424', '2851598', '11197676', '798671', '18579456', '8088', '18482259', '10572287', '33296226', '202872', '19240961', '210064', '68370633', '91421426', '262100', '69714100', '23811', '7584447', '13178881', '40650773', '3505975', '9294567', '35515524', '1381092', '35448754', '1393027', '10469622', '341572', '69983479', '166329', '10943742', '64515527', '1666', '2049060', '862672', '13312617', '2483', '3173675', '12980590', '41322070', '2823774', '10943000', '35664864', '6596080', '81945598', '51048', '35509542', '9408092', '64856089', '1033036', '5090184', '6652033', '10531244', '2619963', '11379911', '18442132', '59730', '18817100', '23542986', '3051050', '109824', '14865469', '18762446', '9866', '18656499', '1019086', '10968784', '19044326', '80429630', '42841', '20226', '64690444', '5006465', '27245597', '16274946', '18135880', '79484745', '17904063', '3556757', '89553992', '18282000', '28149566', '2370342', '19041178', '236535', '13441836', '167335', '82304887', '28481011', '69610848', '5095487', '18815912', '1025575', '19082475', '10328107', '33299157', '102429', '2732417', '3163130', '2733926', '10096635', '13831', '9243189', '1', '95131986', '10003964', '601919', '9341163', '2694187', '5033946', '26630', '1943587', '46903379', '10469264', '18836121', '18796857', '2390229', '65486069', '3726545', '14045632', '9184036', '36166746', '1175268', '10108343', '360894', '2659008', '19089206', '2371071', '28627941', '2677476', '9769', '33583', '1338023', '2684737', '5047250', '24794776', '10123538', '10617623', '144342', '16497', '1570657', '5005', '2770554', '2248263', '18832143', '3337918', '1', '851196', '65349352', '3364958', '5388534', '74551607', '1343294', '35631297', '10290691', '18845983', '634643', '19159910', '35576550', '3311374', '42930813', '288540', '10201068', '26360686', '10656303', '5322538', '9421773', '784549', '2340834', '3518756', '74356837', '76111801', '10393984', '30733510', '18318097', '102843', '68608005', '1471368', '17899609', '70409320', '3560260', '64045627', '2086508', '12595741', '10519133', '23715108', '74954163', '9455978', '279565', '86319', '68310368', '1815218', '2998788', '82845950', '4976234', '2977777', '10417918', '11687539', '926041', '14662093', '2195029', '10595881', '3064987', '1630757', '65073299', '5071248', '5301969', '76167546', '18670398', '10407612', '4222', '18681060', '89874804', '16663', '3276916', '16241404', '65299351', '11503938', '49644962', '1066442', '9359485', '164938', '696896', '3157549', '2724976', '979302', '10398947', '18359698', '73982974', '2331708', '23775', '68518090', '19051818', '10388644', '80336965', '90771927', '2793570', '17962727', '2799946', '76521609', '5372156', '1094835', '33247784', '64420637', '51704284', '167750', '1277290', '3260', '3704165', '3554116', '42853401', '1057848', '76213864', '10858730', '10806989', '18999422', '2667802', '43367961', '2505', '64257237', '2952271', '1103', '86657863', '235824', '9203219', '1143311', '397364', '211706', '6592825', '261886', '13980882', '2186369', '2927629', '18306085', '200327', '10388316', '42295486', '507067', '10888231', '35462987', '82707282', '1616816', '3813083', '35442163', '77708348', '3242406', '10928677', '3542117', '10451641', '10555044', '18834371', '2780396', '18527434', '1045108', '18445647', '52129749', '3587376', '72566', '3231576', '75153174', '16181286', '3793705', '2203309', '13299', '376229', '3420', '3547674', '32845', '163185', '165506', '79302203', '347298', '18544842', '656215', '1301808', '4397729', '28154', '3643262', '11428792', '92889550', '75646561', '6417671', '18683521', '134353', '2645191', '1543410', '14381216', '80952', '43258971', '61440321', '10455313', '30083623', '1616783', '68858659', '18617399', '1', '6428', '14698399', '93293968', '2638889', '67158012', '42426771', '10329455', '30581230', '10389261', '35573984', '167251', '2695021', '35692109', '33181817', '3150436', '14106', '2448705', '15289168', '18205180', '53105856', '37375481', '3476351', '73512772', '2219063', '67088679', '20219', '15240439', '151187', '715747', '283714', '9624', '1376946', '14239', '73010223', '64717271', '9310632', '99211', '8235928', '11013192', '2734132', '1355951', '10959039', '5080353', '6596835', '2445393', '2672915', '74342', '20492630', '77717948', '3877505', '357209', '3211815', '66938931', '13709137', '5259656', '3194934', '89565426', '2893114', '5012112', '2046165', '3206062', '62182400', '2343822', '2598066', '10555', '24799666', '2975969', '35431005', '18198', '68478492', '13633982', '6654085', '11114133', '91012458', '11749608', '71732021', '145050', '2803589', '2307658', '3700099', '71271607', '913697', '76479154', '28999067', '227901', '18850599', '10468991', '15076088', '1', '50220', '36186772', '11709977', '853742', '222204', '14812552', '1214250', '13010349', '6625033', '10607739', '7592908', '9350079', '12953980', '16214053', '2934', '2200287', '10981447', '462458', '2535578', '29118298', '12699415', '11535237', '1311678', '3626155', '33455896', '12952739', '13200414', '7574972', '1028430', '3629447', '3279480', '5101804', '10395713', '9867', '18634628', '303309', '19127121', '214795', '4821616', '3967399', '7947803', '2007443', '80736480', '10436435', '1303869', '314350', '13714804', '37432234', '33693', '413341', '3197010', '3312705', '33200926', '72527895', '11374564', '65877576', '618787', '18677503', '57321', '77063980', '6229', '98226364', '51696315', '1936401', '35505043', '18243911', '70427121', '11073298', '552285', '3334885', '4670', '2746023', '4817733', '11145678', '1284838', '27245365', '201375', '19149', '3594890', '1', '18723495', '7590261', '34768945', '2624908', '6598716', '3802512', '2598034', '92471285', '40801856', '73861108', '5277420', '13459888', '20161610', '585010', '30247941', '18830019', '17950545', '10872551', '18106262', '588163', '33622617', '17751', '694437', '10533787', '68055695', '2642067', '6398258', '1177873', '68735541', '36103678', '10517045', '19029173', '2199951', '1149836', '2619512', '626840', '1', '28407355', '10994292', '1', '11843068', '15793141', '56448634', '37468384', '18000638', '1439333', '2647843', '5274161', '123361', '102790', '8152907', '3545', '10503212', '2821100', '2888017', '18383493', '12469', '150760', '35572169', '90432515', '5179983', '87454473', '19844726', '9230160', '2134612', '10806423', '97190', '19177157', '206993', '2837064', '5401900', '18028748', '2635123', '9432652', '630526', '1336218', '773747', '498704', '6438780', '33265461', '60470', '10926080', '2687116', '3878727', '77386', '1099937', '3374561', '363724', '35678713', '18916005', '15818542', '99595', '3256396', '66341763', '3796710', '2815', '13046818', '7166427', '17944841', '73227250', '1478028', '2517220', '18349595', '2558109', '3514259', '74304634', '29015043', '27158929', '3837556', '72337539', '18045548', '2467945', '71093482', '1', '97321', '1037816', '12898104', '853601', '5054644', '5205148', '9311717', '11761676', '10297214', '72461057', '90927635', '5103346', '628606', '40864632', '16206960', '311167', '10378892', '18887737', '89648017', '64892677', '19146751', '6600800', '353027', '88185696', '19109771', '81140', '26504239', '72200162', '167457', '2609570', '12951398', '3184592', '928245', '3119164', '27419', '2207914', '28658135', '11108875', '3542130', '1328800', '9289194', '3885445', '75650072', '13239491', '27096797', '18453815', '17912335', '6384562', '10821965', '10193176', '423483', '11267000', '25015285', '64554232', '9238808', '18251736', '21389968', '13197574', '74972186', '3925', '2691', '3847185', '18274722', '42819109', '10607336', '24776937', '18005595', '3144198', '21405', '33223', '2569123', '67331904', '1', '68496479', '20479', '384437', '11301003', '3502852', '10691202', '3058566', '74615516', '2429251', '71295040', '19418228', '84937324', '5081485', '2783090', '5037871', '10294739', '1', '141419', '66701790', '81967187', '11154424', '11849983', '49339985', '3595996', '477104', '68055417', '18383206', '2539', '915922', '12952980', '18568189', '14605626', '10388777', '64293875', '3178', '31517', '1589496', '64404350', '22243', '37211716', '76522273', '77654153', '13216774', '31437224', '835110', '1318', '14707748', '1', '1694643', '362798', '2582700', '18290585', '1546241', '3793703', '990222', '96566257', '2864413', '10512405', '1054683', '7587304', '7586422', '1', '2880025', '157240', '2575430', '17957915', '2750227', '2087756', '16170723', '36031', '1', '10209778', '2499210', '162618', '66411', '18633214', '15084149', '18680378', '6408275', '29286405', '6629734', '2839786', '967124', '27737', '9458521']
@pytest.fixture(scope="module")
def linkedin():

    # CAM JORDAN
    proxy_string =  "t1q3o:kmkyo757@169.197.83.74:6006"
    j_session_id = '"ajax:7253057009125232270"'
    li_at = "AQEDATvAZBEFBRHUAAABjopgF9IAAAGOrmyb0k4Al-jkvSUqV3ayCzZgMd3Vz7y8QKiWw-lfVdyf21irApOvoqu20vxEUXLr1cF2cJVqL9HqCU1B3cCL1tSFBHu3T7RH6urlinD-iZ_YCsPTVxx1XzL_"
    user_agent = "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.110 Safari/537.36"
    li_a = "AQJ2PTEmc2FsZXNfY2lkPTMyMDQ2Mjk4NiUzQSUzQTMyMDQ4MTM1NCUzQSUzQXRpZXIxJTNBJTNBMjUzNDM0OTYyurkENjcqnnQd4bOoWpOfvMfWFOU"
    # Elijiah Perez
    # proxy_string =  "proxy-server1.mirrorprofiles.com:8080"
    # j_session_id = '"ajax:0962794415086379039"'
    # li_at = "AQEDAUgtEWEBp4n-AAABjSJ8npIAAAGOdVYJiU4AcYs7aZlIIua3jQecGPV_uLAXTjwWoD78AJxutaybP2bmmBnMYqOusEHQDF43juE6zJxHcT4ISij77bSfeYiZjVsKfESWnZxQ06Hzu6hq5hfMcU__"
    # user_agent = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.110 Safari/537.36"

    #Me
    # proxy_string = "nssnzkvh:i4j9nvkq1rvv@45.196.63.230:6864"
    # j_session_id = '"ajax:1817260717050867186"'
    # li_at = "AQEFARABAAAAAA7XbxgAAAGOZpb7awAAAY6KwHw6TgAAs3VybjpsaTplbnRlcnByaXNlQXV0aFRva2VuOmVKeGpaQUFDdmpJMkp4RE5PeWZoRXBqL2JNc2pSaEFqeEVWNE9waWhzbEJCbTRFUkFLUkpCNGc9XnVybjpsaTplbnRlcnByaXNlUHJvZmlsZToodXJuOmxpOmVudGVycHJpc2VBY2NvdW50OjI0MjYxNTg3NCwyMjgzNTIyMTApXnVybjpsaTptZW1iZXI6MTE4MTkxMDgxJYaz5RNuuBdAuggs3e9bPt0OSa-ysEBPOLtql8rhBxAs_Xia1e4GgtJsbfrOCX1959kLPdOWvXSBYAoeYgRCKZ6vdXUBpObs0J4U90wCXJybe2aXHPq0GZ67hFuB80QbTP_FkMEbmFXs5BJ817Bdee8Gztu7lhQ6JMzKXzKmDsIlXJxLemRMRruhlWczXrqK0mCkGQ"
    # user_agent = "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.110 Safari/537.36Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.110 Safari/537.36"

    #member testing
    li_at = 'AQEDAQcLc-kALnOoAAABjqlh4E8AAAGOzW5kT04ASa_PZkGHLpgpIXWTv8K7AMUyOz1LRblWHMHagBMPn_TsjylO13ng0-h0i2HqWZ9zoUGr4_Wivl77fz5ZpAR5iygV0B7-2BAODiuf7p0n1rqVBScH'
    j_session_id = '"ajax:1817260717050867186"'

    return Linkedin(
        session_cookie=li_at, proxy_string=proxy_string, j_session_id=j_session_id, user_agent=user_agent, debug=True
    )


def test_get_profile(linkedin):
    profile = linkedin.get_profile(public_id='lev-kalashnikov-1a523a286') #urn_id=TEST_PROFILE_ID)
    with open('prof_result.json', 'w') as f:
        json.dump(profile, f)
    assert profile


def test_view_profile(linkedin):
    err = linkedin.view_profile('xiaowang7')

    assert not err


def test_get_profile_privacy_settings(linkedin):
    data = linkedin.get_profile_privacy_settings('joshua-budman-7496b933')
    print(data)
    assert data


def test_get_profile_member_badges(linkedin):
    data = linkedin.get_profile_member_badges(TEST_PUBLIC_PROFILE_ID)

    assert data


def test_get_profile_network_info(linkedin):
    data = linkedin.get_profile_network_info('joshua-budman-7496b933')
    print(data)
    assert data


def test_get_profile_contact_info(linkedin):
    contact_info = linkedin.get_profile_contact_info(TEST_PROFILE_ID)
    assert contact_info


def test_get_profile_connections(linkedin):
    connections = linkedin.get_profile_connections(TEST_PROFILE_ID)
    assert connections


def test_get_conversations(linkedin):
    conversations = linkedin.get_conversations()
    assert conversations


def test_get_conversation_details(linkedin):
    conversation_details = linkedin.get_conversation_details(TEST_PROFILE_ID)
    assert conversation_details


def test_get_conversation(linkedin):
    conversation = linkedin.get_conversation(TEST_CONVERSATION_ID)
    assert conversation


def test_send_message_to_conversation(linkedin):
    err = linkedin.send_message(
        conversation_urn_id=TEST_CONVERSATION_ID,
        message_body="test message from pytest",
    )
    assert not err


def test_send_message_to_recipients(linkedin):
    err = linkedin.send_message(
        recipients=[TEST_PROFILE_ID], message_body="test message from pytest"
    )
    assert not err


def test_mark_conversation_as_seen(linkedin):
    err = linkedin.mark_conversation_as_seen(TEST_CONVERSATION_ID)
    assert not err


def test_get_current_profile_views(linkedin):
    views = linkedin.get_current_profile_views()
    assert views >= 0


def test_get_school(linkedin):
    school = linkedin.get_school("university-of-queensland")
    assert school
    assert school["name"] == "The University of Queensland"


def test_get_company(linkedin):
    company = linkedin.get_company("linkedin")
    assert company
    assert company["name"] == "LinkedIn"


def test_search(linkedin):
    results = linkedin.search({"keywords": "software"})
    assert results


def test_search_pagination(linkedin):
    results = linkedin.search({"keywords": "software"}, limit=4)
    # according to implementation of functions search_people, search_companies
    # limit is valid within the category only. So in every category/type of test
    # the number of results shall not exceed a given limit
    numbers_in_categories = dict()
    for result in results:
        try:
            occurrence = numbers_in_categories[result["type"]]
        except KeyError:
            occurrence = 0
            numbers_in_categories.update({result["type"]: occurrence})
        occurrence += 1
        numbers_in_categories[result["type"]] = occurrence
    assert results
    assert max(numbers_in_categories.values()) == 4


def test_search_with_limit(linkedin):
    results = linkedin.search({"keywords": "tom"}, limit=1)
    assert len(results) == 1


def test_search_people(linkedin):
    results = linkedin.search_people(keywords="software", include_private_profiles=True)
    assert results


def test_search_people_with_limit(linkedin):
    results = linkedin.search_people(
        keywords="software", include_private_profiles=True, limit=1
    )
    assert results
    assert len(results) == 1


def test_search_people_by_region(linkedin):
    results = linkedin.search_people(
        keywords="software", include_private_profiles=True, regions=["105080838"]
    )
    assert results


def test_search_people_by_keywords_filter(linkedin: Linkedin):
    fin_list = random.sample(BIG_CO_LIST, 100)

    results, total_count = linkedin.search_people(
        connection_of='ACoAAACGQVMBsscF5BA6JTumJDTAt_4TT5fhyAg',
        include_private_profiles=True, network_depths=['F','S'],
        current_company=fin_list,
        limit = 25, offset = 0
    )


    assert results
    assert total_count

def test_search_people_by_keywords_filter_navigator(linkedin: Linkedin):
    results, total_count = linkedin.search_people_navigator(
        connection_of='ACoAAAcLc-kBGrxZVGc1BYcF3trNSWWUXQUjswc',
        include_private_profiles=True,
        current_company_list=['1277', '80823467', '120271', '11595','1033'],
        limit = 25, offset = 0
    )

    assert results
    assert total_count

def test_search_jobs(linkedin):
    # test all filters for correct syntax
    # location_name -> "san francisco"
    # companies -> google="1441" or apple="162479"
    # experience ->"1", "2", "3", "4", "5" and "6" (internship, entry level, associate, mid-senior level, director and executive, respectively) 
    # job_type -> "F", "C", "P", "T", "I", "V", "O" (full-time, contract, part-time, temporary, internship, volunteer and "other", respectively)
    # job_title -> software_eng="9",cloud_eng="30006"
    # industries -> computer_hardware="24", it_technology="6"
    # distance -> big number 1000 miles
    # remote -> onsite:"1", remote:"2", hybrid:"3"
    # listed_at -> large number 1000000 seconds
    jobs = linkedin.search_jobs(
        keywords="software engineer",
        location_name="San Francisco",
        companies=["1441","162479"],
        experience=["1","2","3","4","5","6"],
        job_type=["F","C","P","T","I","V","O"],
        job_title=["9","30006"],
        industries=["24","6"],
        distance=1000,
        remote=["1","2","3"],
        listed_at=1000000,
        limit=10
    )
    assert len(jobs)==10

    # Test that no results doesn't return an infinite loop
    jobs = linkedin.search_jobs(
        keywords="blurp",
        location_name="antarctica"
    )
    assert len(jobs)==0


def test_get_job(linkedin):
    jobs = linkedin.search_jobs(
        keywords="software engineer",
        limit=1
    )
    job_id = get_id_from_urn(jobs[0]["trackingUrn"])
    job_info = linkedin.get_job(job_id)
    assert job_info


def test_search_companies(linkedin):
    results = linkedin.search_companies(keywords="linkedin", limit=1)
    assert results
    assert results[0]["urn_id"] == "1337"


# def test_search_people_distinct(linkedin):
#     TEST_NAMES = ['Bill Gates', 'Mark Zuckerberg']
#     results = [linkedin.search_people(name, limit=2)[0] for name in TEST_NAMES]
#     assert results[0] != results[1]


def test_get_profile_skills(linkedin):
    skills = linkedin.get_profile_skills(TEST_PROFILE_ID)
    assert skills


def test_get_invitiations(linkedin):
    invitations = linkedin.get_invitations()
    assert len(invitations) >= 0


def test_accept_invitation(linkedin):
    """
    NOTE: this test relies on the existence of invitations. If you'd like to test this
    functionality, make sure the test account has at least 1 invitation.
    """
    invitations = linkedin.get_invitations()
    if not invitations:
        # If we've got no invitations, just force test to pass
        assert True
        return
    num_invitations = len(invitations)
    invite = invitations[0]
    invitation_response = linkedin.reply_invitation(
        invitation_entity_urn=invite["entityUrn"],
        invitation_shared_secret=invite["sharedSecret"],
        action="accept",
    )
    assert invitation_response

    invitations = linkedin.get_invitations()
    assert len(invitations) == num_invitations - 1


def test_reject_invitation(linkedin):
    """
    NOTE: this test relies on the existence of invitations. If you'd like to test this
    functionality, make sure the test account has at least 1 invitation.
    """
    invitations = linkedin.get_invitations()
    if not invitations:
        # If we've got no invitations, just force test to pass
        assert True
        return
    num_invitations = len(invitations)
    invite = invitations[0]
    invitation_response = linkedin.reply_invitation(
        invitation_entity_urn=invite["entityUrn"],
        invitation_shared_secret=invite["sharedSecret"],
        action="reject",
    )
    assert invitation_response

    invitations = linkedin.get_invitations()
    assert len(invitations) == num_invitations - 1


def test_unfollow_entity(linkedin):
    urn = f"urn:li:member:ACoAACVmHBkBdk3IYY1uodl8Ht4W79rmdVFccOA"
    err = linkedin.unfollow_entity(urn)
    assert not err


def test_get_feed_posts_pagination(linkedin):
    results = linkedin.get_feed_posts(101)
    assert results


def test_get_feed_posts_pagination_with_limit(linkedin):
    results = linkedin.get_feed_posts(4)
    # Currently promotions are always removed from results
    assert len(results) <= 4


def test_get_feed_posts_posts_keys(linkedin):
    results = linkedin.get_feed_posts(4)
    for i in results:
        assert i["author_name"]
        assert i["author_profile"]
        assert i["content"]
        assert i["old"]
        assert i["url"]


def test_get_feed_posts_urns_contains_no_duplicated(linkedin):
    l_posts, l_urns = linkedin._get_list_feed_posts_and_list_feed_urns(101)
    assert len(set([x for x in l_urns if l_urns.count(x) > 1])) == 0


def test_is_request_accepted(linkedin):

    is_accepted = linkedin.is_request_accepted(first_name='James', last_name='Coll', li_url='https://www.linkedin.com/in/james-coll-9198b7165/')
    assert is_accepted

    # is_accepted = linkedin.is_request_accepted(first_name='jason', last_name='Widup', li_url='https://www.linkedin.com/in/jasonwidup')
    # assert is_accepted
    #
    # is_accepted = linkedin.is_request_accepted(first_name='Igor', last_name='mpore', li_url='https://www.linkedin.com/in/igormpore/')
    # assert is_accepted


def test_add_connection(linkedin):

    public_profile_id = 'lev-kalashnikov-1a523a286'

    result = linkedin.add_connection(profile_public_id=public_profile_id)
    print(result)

    assert result

def test_convert_navigator_id(linkedin):
    navigator_id = 'ACwAAACvx6EBAyOcjFD55-q3m2mnvA1H9ceRaik'
    result = linkedin.convert_navigator_id_to_vanity(navigator_id=navigator_id)
    assert result

def test_connection_visibility_off(linkedin):
    response = linkedin.garner_connection_visibility(public_profile_id='joshua-budman-7496b933')


    assert response != True

def test_connection_visibility_on(linkedin):
    response = linkedin.garner_connection_visibility(public_profile_id='lev-kalashnikov-1a523a286')


    assert response

def test_check_for_connected_yes_connected(linkedin):
    response = linkedin.is_request_accepted(vanity_name='lev-kalashnikov-1a523a286')

    assert response

def test_check_for_connected_not_connected(linkedin):

    response = linkedin.is_request_accepted(vanity_name='xiaowang7')

    assert response is False
